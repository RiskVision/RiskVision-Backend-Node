const axios = require('axios');



const getNVDResponse = async () => {
    try {
        const url = "https://services.nvd.nist.gov/rest/json/cves/2.0?keywordSearch=PAX&keywordExactMatch&pubStartDate=2024-08-04T00:00:00.000&pubEndDate=2024-10-22T00:00:00.000";

        const response = await axios.get(url);

        if (!response || response.status !== 200) {
            throw new AppError(`Failed to fetch data: ${response.statusText}`, response.status);
        }

        return response.data.vulnerabilities[0].cve.descriptions[1].value;
    } catch (error) {
        console.error('Error fetching vulnerability:', error);
        return new AppError('Error fetching vulnerability', 500);
    }
}

module.exports = {
    getNVDResponse
};